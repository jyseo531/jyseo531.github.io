---
title: Mip-Nerf 360, CVPR 2022
author: jiyoung
date: 2025-02-08 11:30:00 +0800
categories: [Paper Review]
tags: [Surface reconstruction, Graphics]
---
<script type="text/javascript">
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
    }
  };
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

#### Mip-NeRF 360: Unbounded Anti-Aliased Neural Radiance Fields
- **depth distortion loss**ì˜ ì‹œì´ˆ
  - í˜„ì¬ GSê¸°ë°˜ Surface Reconstruction ì •ê·œí™” í…€ë“¤ì— ë§ì´ ì‚¬ìš©í•¨

### Abstract
- "**unbounded** scene" : í•™ìŠµëœ ë°ì´í„°ì˜ ë°©í–¥(direction)ê³¼ ê±°ë¦¬(distance)ì™€ ë¬´ê´€í•˜ê²Œ ëª¨ë“  rayìƒì— ì¡´ì¬í•˜ëŠ” pointì— ëŒ€í•´ ì˜ í•©ì„±ëœ scene
  - ì£¼ë¡œ ì „ê²½ ë¬¼ì²´ ë¿ë§Œì•„ë‹ˆë¼ ë°°ê²½ê¹Œì§€ ìˆëŠ” sceneì„ ì˜ë¯¸í•¨
- NeRF(Neural Radiance Fields) 
  - volumentric density ë‘ colorë¥¼ MLPë¥¼ í†µí•´ í•©ì„±í•¨
  - MLP : rayìƒì˜ ì‘ì€ 3D pointë“¤ì„ ì´ìš©
  
- **Critical Issues**
  1. Parameterization
  2. Efficiency
  3. Ambiguity

<br>

### Preliminaries : mip-NeRF
- ray : $\mathrm{r}(t) = \mathrm{o} + t\mathrm{d}$ ê°€ ìˆì„ ë•Œ,
- distance $t$ì— ì˜í•´ì„œ ì •ë ¬ëœ ë²¡í„°ê°€ ì •ì˜ë˜ê³  rayê°€ tì— ëŒ€í•œ êµ¬ê°„ì˜ ì§‘í•©ìœ¼ë¡œ ìª¼ê°œì§„ë‹¤ $T_i = [t_i, t_{i+1}]$
- ê° êµ¬ê°„ë§ˆë‹¤ ì›ë¿”ëŒ€(conical frustum)ì˜ í‰ê· ê³¼ ê³µë¶„ì‚°$(\mu, \Sigma)=\mathrm{r}(T_i)$ì„ ê³„ì‚°í•¨
  - rayì˜ focal lengthì™€ image planeì˜ í”½ì…€ì‚¬ì´ì¦ˆì— ì˜í•´ì„œ ê²°ì •ë¨
  - **featureize ë‹¨ê³„(IPE, Integratged positional Encoding)**

      $$ \gamma(\mu, \Sigma) =\left\{\begin{bmatrix}
        \sin(2\ell \mu) \exp\left(-2^ {2\ell-1} \operatorname{diag}(\Sigma)\right) \\
        \cos(2\ell \mu) \exp\left(-2^ {2\ell-1} \operatorname{diag}(\Sigma)\right)
        \end{bmatrix}
        \right\}_{\ell=0}^{L-1} $$

   
- ìœ„ ê°’ë“¤ì´ MLPì˜ inputìœ¼ë¡œ ë“¤ì–´ê°€ê³ , MLP weightì¸ $\Theta_{NeRF}$ì™€ ê°™ì´ ë“¤ì–´ê°€ì„œ **density** $\tau$ì™€ **color** $\mathrm{c}$ë¥¼ ì¶œë ¥í•¨ :
  - $$\forall T_i \in t, \quad (\tau_i, c_i) = \text{MLP}(\gamma(r(T_i)); \Theta_{\text{NeRF}})$$
- view direction $\mathrm{d}$ë„ MLPì— ê°™ì´ ë“¤ì–´ê°
- Volume renderingì„ í†µí•´ ë Œë”ë§ë˜ëŠ” ìµœì¢… pixel color $\mathrm{C}(\mathrm{r}, t)$ :

  $$ \begin{align} \mathrm{C}(\mathrm{r}, t) = \sum_limits_i w_i c_i \\ 
      w_i = (1-e^{-\tau_i(t_{i+_1} - t_i)})e^{-\sum_{i' < i}\tau_{i'}(t_{i'+1}-t_{i'})} \end{align} $$

- NeRFëŠ” ë‘ ê°œì˜ ì„œë¡œ ë‹¤ë¥¸ MLP (â€œcoarseâ€ MLPì™€ â€œfineâ€ MLP)ë¥¼ ì‚¬ìš©í•˜ëŠ” ê³„ì¸µì  ìƒ˜í”Œë§ ì ˆì°¨ë¥¼ ì‚¬ìš© :
  - $t^c \sim U[t_n, t_f], \quad t^c = \operatorname{sort}(\{t^c\}) $
  - $t^f \sim hist[t^c, w^c], \quad t^f = \operatorname{sort}(\{t^f\}) $

- **final loss** (combination of coarse and fine reconstruction loss) :

    $$ 
    \sum_{\mathbf{r} \in \mathcal{R}} \frac{1}{10} 
    \mathcal{L}_{\text{recon}} \left( \mathbf{C}(\mathbf{r}, t^c), \mathbf{C}^*(\mathbf{r}) \right) 
    + \mathcal{L}_{\text{recon}} \left( \mathbf{C}(\mathbf{r}, t^f), \mathbf{C}^*(\mathbf{r}) \right)
    $$

---

### 1. Scene and Ray Parameterization
#### 1.1. 3D coordinate $x#ì— ëŒ€í•œ Parameterization
- ê¸°ì¡´ì˜ ì—°êµ¬ë“¤ì€ unbounded sceneì— ëŒ€í•´ pointë¥¼ íŒŒë¼ë¯¸í„°í™”í–ˆì§€ë§Œ, ë³¸ ë…¼ë¬¸ì—ì„œëŠ” Gaussianì„ ì¬íŒŒë¼ë¯¸í„°í™”í•˜ì˜€ë‹¤
- $f(x)$ : smooth coordinate transformation function ë˜ëŠ” state transition modelì´ë¼ê³  ì •ì˜
- $f$ ì— ëŒ€í•œ ì„ í˜• ê·¼ì‚¬ = $f(x)â‰ˆf(Î¼)+J_f(Î¼)(xâˆ’Î¼)$
  - where, $J$: $\mu$ì—ì„œì˜ fí•¨ìˆ˜ì— ëŒ€í•œ ìŸˆì½”ë¹„ì•ˆ í–‰ë ¬
  
  $$ \begin{align} f(Î¼,Î£)=(f(Î¼),J_f(Î¼)Î£Jf(Î¼)âŠ¤) \end{align} $$

- **Extended Kalman Filter**ì´ë‘ ë¹„ìŠ·í•˜ê²Œ ì‘ë™í•¨
  - Contract í•¨ìˆ˜ : point xë¥¼ ì…ë ¥ë°›ì•„ íŠ¹ì • ë°˜ì§€ë¦„(1,2)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë³€í˜•í•˜ëŠ” ì—°ì‚°

    $$ 
    \text{contract}(x) =
    \begin{cases} 
    x, & \text{if } \|x\| \leq 1 \\
    \left(2 - \frac{1}{\|x\|} \right) \left(\frac{x}{\|x\|} \right), & \text{if } \|x\| > 1
    \end{cases}
    $$

-  ì˜ë¯¸ 
   - xê°€ 1ë³´ë‹¤ í° ê²½ìš°(ê·¸ë¦¼ì—ì„œ ì£¼í™©ìƒ‰ ë²”ìœ„ì¸ ê²½ìš°)ì—ëŠ” ë²¡í„°ë¥¼ ë°©í–¥ì€ ìœ ì§€í•˜ë©´ì„œ íŠ¹ì • í¬ê¸°ë¡œ ì¶•ì†Œ(ìˆ˜ì¶•, contract)
   - ë³€í˜•ëœ í¬ê¸°ëŠ” $2âˆ’1âˆ¥xâˆ¥2âˆ’âˆ¥xâˆ¥1â€‹$ ë¡œ ì¡°ì •ë¨ , ë²¡í„°ë¥¼ ë‹¨ìœ„ ë²¡í„°ë¡œ ë³€í™˜í•œ í›„ í¬ê¸°ë¥¼ ë‹¤ì‹œ ìŠ¤ì¼€ì¼ë§í•˜ëŠ” ë°©ì‹
   - => ê±°ë¦¬ê°€ ë©€ë¦¬ ë–¨ì–´ì ¸ ìˆì„ìˆ˜ë¡ **disparity(ì‹œì  ì°¨) ì¦‰, distanceì˜ ì—­ìˆ˜**ë§Œí¼ ë¹„ìœ¨ì ìœ¼ë¡œ ë¶„í¬í•˜ê²Œ í•´ì¤Œ
   - **NDC(normalzed device coordinate)**ì™€ ê°™ì€ motivation

- ë³¸ ë…¼ë¬¸ì—ì„œëŠ” ì•„ë˜ì˜ ì‹ì— ë”°ë¼ ìœ í´ë¦¬ë“œ ê³µê°„ì—ì„œ mip-NeRFì˜ IPE feature encoding($\gamma$) inputìœ¼ë¡œ *ì¶•ì†Œëœ ê³µê°„ì—ì„œì˜ contractí•¨ìˆ˜ ë°˜í™˜ ê°’*($\gamma(\text{contract}(x))$)ì„ ê°ë§ˆ í•¨ìˆ˜ì— ì§‘ì–´ë„£ëŠ”ë‹¤
  
#### 2. êµ¬ê°„ì„ ë‚˜ëˆŒ ê´‘ì„  ê±°ë¦¬ $t$ì— ëŒ€í•œ Parameterization :
- ì¼ë°˜ì ì¸ NeRFì—ì„œëŠ” uniform distributionì—ì„œ $t_n$(ê·¼ê±°ë¦¬)ê³¼ $t_f$(ì›ê±°ë¦¬)ì‚¬ì´ êµ¬ê°„ì—ì„œ ìƒ˜í”Œë§í•œ ê´‘ì„ ê±°ë¦¬ $t^c$ë¥¼ ì •ë ¬í•˜ì—¬ ì‚¬ìš©
  - í•˜ì§€ë§Œ, Scene parameterizationì—ì„œ **NDC**ì²˜ëŸ¼ ì—­í• í•˜ëŠ” ì¶•ì†Œëœ ê³µê°„ì—ì„œì˜ state transition ê³¼ì •ìœ¼ë¡œ ì¸í•´ì„œ ì‹¤ì œë¡œëŠ” ê¹Šì´ì˜ ì—­ìˆ˜(disparity)ê°„ê²©ìœ¼ë¡œ ê· ì¼í•˜ê²Œ ìƒ˜í”Œë“¤ì´ ë°°ì¹˜ëœë‹¤.
  - ì´ ìƒí™©ì€ ì¹´ë©”ë¼ ë°©í–¥ì´ í•˜ë‚˜ë§Œ ì¡´ì¬í•˜ëŠ” unbounded sceneì—ëŠ” ì í•©í•˜ê² ì§€ë§Œ, **ë°©í–¥ì´ ë‹¤ë¥¸ ëª¨ë“  ë·°**ì— ëŒ€í•œ unbounded sceneì„ ë³µì›í•˜ëŠ” ë°ì—ëŠ” ì í•©í•˜ì§€ ì•Šë‹¤
- *ìœ í´ë¦¬ë””ì•ˆ ê³µê°„*ì— ìˆëŠ” ray distance $t$ë¥¼ *"normalized" ray distance* $s$ë¡œ **ì—­ë§¤í•‘**í•´ì£¼ëŠ” ê²ƒì´ í•„ìš” :

  $$
  s \triangleq \frac{g(t) - g(t_n)}{g(t_f) - g(t_n)}, \quad 
  t \triangleq g^{-1} \left( s \cdot g(t_f) + (1 - s) \cdot g(t_n) \right), \quad (11)
  $$

  - ì—¬ê¸°ì„œ gëŠ” ê°€ì—­(ì •ê·œí™”ëœ ê°’ì„ ì¶œë ¥í•´ì£¼ëŠ”)í•¨ìˆ˜

<br>

### 2. Coarse-to-Fine <u>Online Distillation</u>
- **Mip-NeRF** :
  - MLPì—ì„œ "coarse" ray interval $t^c$ì„ ì‚¬ìš©í•˜ì—¬ í•œ ë²ˆ í‰ê°€í•˜ê³ , ë‹¤ì‹œ "fine" ray interval $t^f$ë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ê°€ë˜ë©°, ë‘ ìˆ˜ì¤€ ëª¨ë‘ì—ì„œ image reconsruction lossë¥¼ ì‚¬ìš©

- **Mip-NeRF 360** : 
  - ë‘ ê°€ì§€ì˜ MLPí•™ìŠµ(NeRF MLP $\Theta_{NeRF}$ & Proposal MLP $\Theta_{prop}$)
    1. **NeRF MLP** $\Theta_{NeRF}$ : ê¸°ì¡´ Mip-NeRFì—ì„œ ì‚¬ìš©í•˜ë˜ MLP
    2. **Proposal MLP** $\Theta_{prop}$ : volumetric **densityë§Œ** ì—ì¸¡í•¨, **color**ëŠ” ì˜ˆì¸¡í•˜ì§€ ì•ŠìŒ
      - outputì˜ volumetric densityê°€ ë‹¤ì‹œ **weight vector** $\hat{w}$ë¡œ ë°˜í™˜ë¨ 
      - proposal ê°€ì¤‘ì¹˜ $\hat{w}$ëŠ” ìì²´ ê°€ì¤‘ì¹˜ ë²¡í„° $w$ë¥¼ ì˜ˆì¸¡í•˜ëŠ” NeRF MLPì— ì œê³µë˜ëŠ” $s$-ê°„ê²©ì„ ìƒ˜í”Œë§í•˜ëŠ” ë° ì‚¬ìš©
      - ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ì¬í˜„í•˜ë„ë¡ í•™ìŠµë˜ì§€ ì•Šê³  ëŒ€ì‹  NeRF MLPì— ì˜í•´ ìƒì„±ëœ ê°€ì¤‘ì¹˜ $w$ë¥¼ ì œí•œí•˜ë„ë¡ í•™ìŠµ
    - ë‘ MLP ëª¨ë‘ ëœë¤í•˜ê²Œ ì´ˆê¸°í™”ë˜ê³  ê³µë™ìœ¼ë¡œ í•™ìŠµë˜ë¯€ë¡œ ì´ supervisionì€ NeRF MLP ì§€ì‹ì„ proposal MLPì— ëŒ€í•œ ì¼ì¢…ì˜ **â€œonline distillation"**ë¡œ ìƒê°í•¨
  - proposal MLP $(\hat{\mathrm{t}}, \hat{\mathrm{w}})$ì™€ NeRF MLP $(\mathrm{t},\mathrm{w})$ì˜ **íˆìŠ¤í† ê·¸ë¨ì´ ì¼ê´€ë˜ë„ë¡ ì¥ë ¤í•˜ëŠ” loss function**ì´ í•„ìš”
    - ì´ ë•Œ ë‘ íˆìŠ¤í† ê·¸ë¨ xì¶• binê¸¸ì´ê°€ ë™ì¼í•  í•„ìš”ê°€ ì—†ìŒ, ì•„ë‹ˆ ì˜¤íˆë ¤ ë‹¬ë¼ì ¸ì•¼ proposal MLPê°€ ì˜ í•™ìŠµë˜ì—ˆë‹¤ëŠ” ê·¼ê±°ì„
    - ë”°ë¼ì„œ binì´ ë‹¤ë¥¼ ë•Œì˜ íˆìŠ¤í† ê·¸ë¨ ìœ ì‚¬ì„±ì„ í‰ê°€í•˜ëŠ” í†µê³„ì  ë°©ë²•ë¡  ì—°êµ¬ë“¤ì´ ìƒëŒ€ì ìœ¼ë¡œ ë¶€ì¡±í•˜ê¸° ë•Œë¬¸ì— ê½¤ ì–´ë ¤ìš´ ë¬¸ì œì„
      - $\text{bound}(\hat{\mathrm{t}}, \hat{\mathrm{w}}, T) = \sum\limits_{j : T \cap \hat{T}_j neq \emptyset}\hat{w_j} .$
      - ë§Œì•½ ë‘ íˆìŠ¤í† ê·¸ë¨ì´ ì„œë¡œ ì¼ê´€(ì¼ì¹˜)í•˜ë©´, $(\mathrm{t},\mathrm{w})$ì˜ ëª¨ë“  ê°„ê²© $(T_i, w_i)$ì— ëŒ€í•´ $w_i \leg \text{bound}((\hat{\mathrm{t}}, \hat{\mathrm{w}}), T_i)$ê°€ ëª¨ë“  êµ¬ê°„ì— ëŒ€í•´ ì„±ë¦½í•´ì•¼ í•¨
      - ì´ ì„±ì§ˆ ì´ìš©í•´ì„œ $L_{prop}$ ì„¤ê³„ :
  
      $$\begin{align} \mathcal{L}_{\text{prop}} (\mathbf{t}, \mathbf{w}, \hat{\mathbf{t}}, \hat{\mathbf{w}}) =
      \sum_i \frac{1}{w_i} \max \left( 0, w_i - \text{bound} (\hat{\mathbf{t}}, \hat{\mathbf{w}}, T_i) \right)^2,
      \end{align}$$

  ![img.png](assets/img/posts_storage/mipnerf-360/213.png)

<br>

### 3. <u>Regularization</u> for Interval-Based Models (Depth distortion loss)
- **"floater"**ê°€ ë°œìƒí•˜ê±°ë‚˜ **"back-ground collapse"**ê°€ ë°œìƒí•˜ëŠ” ê²°í•¨ ìƒí™©ì—ì„œ ì˜ í•´ê²°í•  ìˆ˜ ìˆìŒ
- ì •ê·œí™”ëœ ray distance $s$ì™€ blending weight $w$ê°„ì˜ step functionìœ¼ë¡œ êµ¬ì„±ë¨
  
  $$\begin{align}  \mathcal{L}_{\text{dist}} (\mathbf{s}, \mathbf{w}) =
  \int_{-\infty}^{\infty} \int_{-\infty}^{\infty} 
  w_{\mathbf{s}}(u) w_{\mathbf{s}}(v) |u - v| \, d u \, d v, \end{align} $$

  - where, w_s(u)ëŠ” $u$ì—ì„œ $(s,w)$ì— ì˜í•´ ì •ì˜ëœ step functionì— ëŒ€í•œ ë³´ê°„ì´ë‹¤.
  - $ w_s(u)=\sum_i w_i ğŸ™[s_i,s_{i+1})(u) $
- ìœ„ ì ë¶„ ì‹ì€ ì •ì˜ëŠ” ì§ê´€ì ì´ì§€ë§Œ ê³„ì‚°í•˜ëŠ” ê²ƒì´ ì–´ë µê¸° ë•Œë¬¸ì—, ì•„ë˜ ì‹ìœ¼ë¡œ rewrittení•  ìˆ˜ ìˆìŒ
  
    $$\begin{align} \mathcal{L}_{\text{dist}} (\mathbf{s}, \mathbf{w}) =
    \sum_{i,j} w_i w_j \left| \frac{s_i + s_{i+1}}{2} - \frac{s_j + s_{j+1}}{2} \right|
    + \frac{1}{3} \sum_i w_i^2 (s_{i+1} - s_i)  \end{align}$$

- *ì²« ë²ˆì§¸ í•­*ì€ ëª¨ë“  intervalì— ëŒ€í•œ midpointì‚¬ì´ì˜ weighted distances ìµœì†Œí™” term, *ë‘ ë²ˆì§¸ í•­*ì€ ê°ê°ì˜ intervalì— ëŒ€í•œ weighted sizeë¥¼ ìµœì†Œí™”í•˜ëŠ” í…€ì´ë‹¤.
  
<br>

## ëŠë‚€ì 
- ì´ì „ì— ë‚˜ì˜¨ ëª¨ë¸ë¡œ Mip-NeRF(ICLR 2021)ê°€ ìˆëŠ”ë° ray tracing based volume renderingì´ ì•„ë‹ˆë¼, "Cone" tracingí•œë‹¤ëŠ” ì ì´ ê°€ì¥ í° íŠ¹ì§•ì¸ ê²ƒë§Œ ì•Œê³  ì½ì€ ìƒíƒœë¼ ëª¨ë“  ìˆ˜ì‹ì´ ë§¤ë„ëŸ½ê²Œ ì´í•´ë˜ì§„ ì•Šì•˜ë‹¤
- NeRFìì²´ë¥¼ ì œëŒ€ë¡œ ê³µë¶€í•´ë³¸ì ì´ ì—†ì—ˆì–´ì„œ ì˜ ì´í•´ê°€ ì•ˆë˜ëŠ” ê²Œ ë§ê¸´ í•˜ëŠ”ë° ì–¸ì  ê°€ ê³µë¶€ ê¸‰í•œê±´ ì•„ë‹˜
